$(document).ready(function() {
    function e(e) {
        try {
            JSON.parse(e)
        } catch (e) {
            return !1
        }
        return !0
    }
    function t(e) {
        e ? ($("#user-feed-submit").addClass("tof-button-forbidden"),
        $("#user-feed-email, #user-feed-reason").attr("disabled", !0)) : ($("#user-feed-submit").removeClass("tof-button-forbidden"),
        $("#user-feed-email, #user-feed-reason").attr("disabled", !1))
    }
    function o(e, t) {
        var o = "alert" == e ? "alert" : "success";
        $(".tof-user-response-details-header").attr("class", "tof-user-response-details-header"),
        $(".tof-user-response-details-header").addClass(o),
        $(".tof-user-response-field-des").html(t)
    }
    function s(e) {
        e ? ($("#tof-bug-report").addClass("tof-button-forbidden"),
        $(".tof-user-report-bug-attachment").addClass("tof-user-report-bug-attachment-forbidden"),
        $("#tof-bug-userfname, #tof-bug-userlname, #tof-bug-useremail, #tof-bug-issue, #tof-bug-description").attr("disabled", !0)) : ($("#tof-bug-report").removeClass("tof-button-forbidden"),
        $(".tof-user-report-bug-attachment").removeClass("tof-user-report-bug-attachment-forbidden"),
        $("#tof-bug-userfname, #tof-bug-userlname, #tof-bug-useremail, #tof-bug-issue, #tof-bug-description").attr("disabled", !1))
    }
    function r(e, t, o) {
        var r = o ? "flex" : "none";
        $(".tof-user-report-bug-error-wrapper").css("display", r),
        "success" == t ? $(".tof-user-report-bug-error-wrapper").addClass("tof-success") : (s(!1),
        $(".tof-user-report-bug-error-wrapper").removeClass("tof-success")),
        $(".tof-user-report-bug-error").html(e)
    }
    function a() {
        var e = $("#user-feed-email").val()
          , t = $("#user-feed-email").attr("data-defaultValue")
          , o = $("#user-feed-reason").val()
          , s = $("#user-feed-reason").attr("data-defaultValue");
        return t == e && s == o
    }
    var n = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    $(".tof-fixed-more").on("click", function() {
        $(this).hasClass("tof-fixed-more-default") ? ($(this).attr("class", "tof-fixed-more"),
        $(this).addClass("tof-fixed-more-open"),
        $(".tof-fixed-icons").show()) : ($(this).attr("class", "tof-fixed-more"),
        $(this).addClass("tof-fixed-more-default"),
        $(".tof-fixed-icons").hide())
    }),
    $(".tof-fixed-icons, .tof-fixed-more").on("click", function(e) {
        e.stopPropagation()
    }),
    $(document).on("click", function() {
        $(".tof-fixed-more").attr("class", "tof-fixed-more"),
        $(".tof-fixed-more").addClass("tof-fixed-more-default"),
        $(".tof-fixed-icons").hide()
    }),
    $(".tof-user-response-card-cancel").on("click", function(e) {
        $(".tof-user-response-card").hide(),
        $(".tof-user-response-overlay").hide(),
        $("body").css("overflow", "")
    }),
    $(".tof-feedback-wrapper").on("click", function() {
        $(".tof-user-response-overlay").css("display", "flex"),
        $(".tof-user-response-feedback").show(),
        $("body").css("overflow", "hidden")
    }),
    $(".tof-user-response-header-close").on("click", function() {
        $(".tof-user-response-card").hide(),
        $(".tof-user-response-overlay").hide(),
        $("body").css("overflow", "")
    });
    var i = 0;
    $(".user-feed-rating").on("click", function() {
        i = parseInt($(this).index()) + 1,
        userDefSelRating = parseInt($(".tof-user-response").attr("data-rating")),
        i != userDefSelRating ? $("#user-feed-submit").removeClass("tof-button-forbidden") : a() && $("#user-feed-submit").addClass("tof-button-forbidden"),
        $(".user-feed-rating").removeClass("tof-user-response-selected"),
        $(this).addClass("tof-user-response-selected")
    }),
    $(".tof-user-response-selected").trigger("click"),
    $("#user-feed-submit").on("click", function() {
        t(!0);
        var s = $('meta[name="csrf-token"]').attr("content")
          , r = $("#user-feed-email").val()
          , a = $("#user-feed-reason").val()
          , u = window.location.pathname;
        "" != r && n.test(r) ? ($(".tof-user-response-field input, .tof-user-response-field textarea").css({
            "border-color": "",
            outline: ""
        }),
        o("success", "Please drop us your feedback"),
        $.ajax({
            type: "POST",
            url: "/assets/others/php/sp/handleFeedback.php",
            data: {
                csrfToken: s,
                userRating: i,
                useremail: r,
                userfeedback: a,
                pathname: u
            },
            success: function(o) {
                if (e(o)) {
                    var s = JSON.parse(o);
                    "success" == s.status ? ("updated" == s.data.type ? $(".tof-user-response-submitted-head").html("Feedback Updated") : $(".tof-user-response-submitted-head").html("Feedback Submitted"),
                    $(".tof-user-response-submitted").css("display", "flex")) : "failed" == s.status && (t(!1),
                    "201" == s.error.code ? ($("#user-feed-email").focus(),
                    $("#user-feed-email").css({
                        "border-color": "#c00",
                        outline: "1px solid #c00"
                    })) : "205" == s.error.code && $("#user-feed-email, #user-feed-reason").css({
                        "border-color": "#c00",
                        outline: "1px solid #c00"
                    }))
                }
            }
        })) : ($(".tof-user-response-field input, .tof-user-response-field textarea").css({
            "border-color": "",
            outline: ""
        }),
        "" == r ? (t(!1),
        $("#user-feed-email").focus(),
        $("#user-feed-email").css({
            "border-color": "#c00",
            outline: "1px solid #c00"
        }),
        o("alert", "Please enter your email")) : n.test(r) || (t(!1),
        $("#user-feed-email").focus(),
        $("#user-feed-email").css({
            "border-color": "#c00",
            outline: "1px solid #c00"
        }),
        o("alert", "Please enter a valid email")))
    }),
    $("#user-feed-email, #user-feed-reason").on("focus", function() {
        $(this).css({
            "border-color": "",
            outline: ""
        })
    }),
    $("#user-feed-email, #user-feed-reason").on("input", function() {
        a() ? $("#user-feed-submit").addClass("tof-button-forbidden") : $("#user-feed-submit").removeClass("tof-button-forbidden")
    }),
    $(".tof-report-bug-wrapper").on("click", function() {
        $(".tof-user-response-overlay").css("display", "flex"),
        $(".tof-user-report-bug-wrapper").show(),
        $("body").css("overflow", "hidden")
    }),
    $(".tof-user-report-bug-cancel").on("click", function() {
        $(".tof-user-response-card").hide(),
        $(".tof-user-response-overlay").hide(),
        $("body").css("overflow", "")
    }),
    $(".tof-user-report-bug-wrapper input").on("input", function() {
        $(this).removeClass("tof-error")
    }),
    $(".tof-user-report-bug-attachment").on("click", function() {
        $("#tof-bug-attachment").trigger("click")
    });
    var u = !1
      , f = "";
    $("#tof-bug-attachment").on("change", function() {
        f = $(this)[0].files[0],
        $(".tof-user-report-bug-attachment-text").html("Selected - " + f.name),
        f && (u = !0)
    }),
    $("#tof-bug-report").on("click", function() {
        var t, o, a, i, d;
        if (s(!0),
        t = $("#tof-bug-userfname").val(),
        o = $("#tof-bug-userlname").val(),
        a = $("#tof-bug-useremail").val(),
        i = $("#tof-bug-issue").val(),
        d = $("#tof-bug-description").val(),
        "" != t && "" != a && "" != i && "" != d)
            if (t.length >= 3)
                if (n.test(a))
                    if (d.length >= 50) {
                        r("Reporting your bug...", "success", !0);
                        var c = $('meta[name="csrf-token"]').attr("content")
                          , l = window.location.pathname;
                        reportData = new FormData,
                        reportData.append("csrfToken", c),
                        reportData.append("fname", t),
                        reportData.append("lname", o),
                        reportData.append("useremail", a),
                        reportData.append("issue", i),
                        reportData.append("bugDetail", d),
                        reportData.append("pathname", l),
                        u && reportData.append("attachment", f),
                        $.ajax({
                            type: "POST",
                            url: "/assets/others/php/sp/handleReportBug.php",
                            data: reportData,
                            contentType: !1,
                            processData: !1,
                            success: function(t) {
                                if (e(t)) {
                                    var o = JSON.parse(t);
                                    o.hasOwnProperty("status") ? "success" == o.status ? r("Your bug is successfully reported. Please wait for our response. We'll soon analyze and solve the bug", "success", !0) : "failed" == o.status && r(o.error.message, "alert", !0) : r("Something Went Wrong. Try again later.", "alert", !0)
                                }
                            }
                        })
                    } else
                        r("Please describe the issue in at least 50 characters", "alert", !0);
                else
                    r("Please enter a valid email address", "alert", !0);
            else
                r("Your name should have at least 3 characters", "alert", !0);
        else
            "" == t ? ($("#tof-bug-userfname").addClass("tof-error"),
            r("Please enter a valid name", "alert", !0)) : "" == a ? ($("#tof-bug-useremail").addClass("tof-error"),
            r("Please enter your email", "alert", !0)) : "" == i ? ($("#tof-bug-issue").addClass("tof-error"),
            r("Please select an issue", "alert", !0)) : "" == d && ($("#tof-bug-description").addClass("tof-error"),
            r("Please elaborate your bug", "alert", !0))
    }),
    $(".tof-share-wrapper").on("click", function() {
        $(".tof-user-response-overlay").css("display", "flex"),
        $(".tof-user-share-wrapper").show(),
        $("body").css("overflow", "hidden")
    }),
    $(".tof-share-copy").on("click", function() {
        var e = window.location.href
          , t = $(this)
          , o = $("<input>");
        $("body").append(o),
        o.val(e).select(),
        document.execCommand("copy"),
        o.remove(),
        $(this).parent().addClass("tof-share-copied"),
        setTimeout(function() {
            t.parent().removeClass("tof-share-copied")
        }, 2e3)
    }),
    $(".tof-share-facebook").on("click", function() {
        var e = window.location.href
          , t = "http://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(e);
        window.open(t)
    }),
    $(".tof-share-whatsapp").on("click", function() {
        var e = window.location.href
          , t = $("title").text()
          , o = "*" + t + "*\n" + $("meta[name=description]").attr("content") + "\n\n*Visit ðŸ‘‰* *" + e + "*"
          , s = "https://api.whatsapp.com/send?text=" + encodeURIComponent(o);
        window.open(s)
    }),
    $(".tof-share-twitter").on("click", function() {
        var e = window.location.href
          , t = $("meta[name=description]").attr("content")
          , o = "http://twitter.com/share?text=" + encodeURIComponent(t) + "&url=" + encodeURIComponent(e);
        window.open(o)
    }),
    $(".tof-share-email").on("click", function() {
        var e = window.location.href
          , t = $("meta[name=description]").attr("content") + "\nVisit ðŸ‘‰ " + e
          , o = "mailto:?subject=Check out this awesome website!&body=" + encodeURIComponent(t);
        window.open(o)
    })
});